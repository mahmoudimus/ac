<atlassian-plugin key="${project.groupId}.${project.artifactId}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}" />
    </plugin-info>

    <servlet-filter key="fixAuthenticateHeader" class="com.atlassian.labs.remoteapps.installer.FixAuthenticateHeaderFilter"
            location="after-encoding">
        <url-pattern>/rest/remoteapps/*</url-pattern>
    </servlet-filter>
    <servlet-filter key="iframe-resources" class="com.atlassian.labs.remoteapps.iframe.StaticResourcesFilter"
            location="after-encoding">
        <url-pattern>/remoteapps/*</url-pattern>
    </servlet-filter>

    <servlet-filter key="api-scoping" class="com.atlassian.labs.remoteapps.modules.permissions.ApiScopingFilter"
            location="before-decoration">
        <url-pattern>/*</url-pattern>
    </servlet-filter>

    <servlet-filter key="oauth-2lo-authentication" class="com.atlassian.labs.remoteapps.modules.oauth.OAuth2LOFilter"
            location="after-encoding">
        <url-pattern>/*</url-pattern>
    </servlet-filter>

    <module-type key="remote-app" class="com.atlassian.labs.remoteapps.descriptor.RemoteAppModuleDescriptor" />

    <web-resource key="xdm">
        <context>remoteapps-iframe</context>
        <dependency>com.atlassian.auiplugin:ajs</dependency>
        <resource type="download" name="easyXDM.js" location="/js/iframe/easyXDM.js" />
    </web-resource>

    <web-resource key="iframe">
        <resource type="download" name="easyXDM.js" location="/js/iframe/easyXDM.js" />
        <resource type="download" name="main.js" location="/js/iframe/main.js" />
    </web-resource>

    <rest key="rest" path="/remoteapps" version="1" package="com.atlassian.labs.remoteapps.rest">
        <dispatcher>REQUEST</dispatcher>
        <dispatcher>INCLUDE</dispatcher>
    </rest>

    <component key="applicationTypeGenerator" class="com.atlassian.labs.remoteapps.modules.applinks.ApplicationTypeModuleGenerator" />
    <component key="entityTypeGenerator" class="com.atlassian.labs.remoteapps.modules.applinks.EntityTypeModuleGenerator" />
    <component key="adminPageGenerator" class="com.atlassian.labs.remoteapps.modules.admin.AdminPageModuleGenerator" />
    <component key="oauthGenerator" class="com.atlassian.labs.remoteapps.modules.oauth.OauthModuleGenerator" />
    <component key="permissionsManager" class="com.atlassian.labs.remoteapps.modules.permissions.PermissionsModuleGenerator" />
    <component key="remoteAppInstaller" class="com.atlassian.labs.remoteapps.installer.DefaultRemoteAppInstaller" />
    <component key="apiPermissionManager" class="com.atlassian.labs.remoteapps.ApiPermissionManager" />
    <component key="oauthLinkManager" class="com.atlassian.labs.remoteapps.OAuthLinkManager" />
    <component key="startableForPlugins" class="com.atlassian.labs.remoteapps.descriptor.StartableForPlugins" public="true" interface="com.atlassian.sal.api.lifecycle.LifecycleAware" />
    <component key="2loAuthenticator" class="com.atlassian.labs.remoteapps.modules.oauth.OAuth2LOAuthenticator" />

    <component key="confluenceProductAccessor" class="com.atlassian.labs.remoteapps.product.ConfluenceProductAccessor" application="confluence" />
    <component key="jiraProductAccessor" class="com.atlassian.labs.remoteapps.product.JiraProductAccessor" application="jira" />
    <component key="refappProductAccessor" class="com.atlassian.labs.remoteapps.product.RefappProductAccessor" application="refapp" />

    <component-import key="templateRenderer" interface="com.atlassian.templaterenderer.TemplateRenderer"/>
    <component-import key="servletModuleManager" interface="com.atlassian.plugin.servlet.ServletModuleManager" />
    <component-import key="webInterfaceManager" interface="com.atlassian.plugin.web.WebInterfaceManager" />
    <component-import key="pluginRetrievalService" interface="com.atlassian.plugin.osgi.bridge.external.PluginRetrievalService" />
    <component-import key="oauthConsumerService" interface="com.atlassian.oauth.consumer.ConsumerService" />
    <component-import key="requestFactory" interface="com.atlassian.sal.api.net.RequestFactory" />
    <component-import key="pluginController" interface="com.atlassian.plugin.PluginController" />
    <component-import key="applicationProperties" interface="com.atlassian.sal.api.ApplicationProperties" />
    <component-import key="serviceProviderConsumerStore" interface="com.atlassian.oauth.serviceprovider.ServiceProviderConsumerStore" />
    <component-import key="applicationLinkService" interface="com.atlassian.applinks.spi.link.MutatingApplicationLinkService" />
    <component-import key="authenticationConfigurationManager" interface="com.atlassian.applinks.spi.auth.AuthenticationConfigurationManager" />
    <component-import key="userManager" interface="com.atlassian.sal.api.user.UserManager" />
    <component-import key="authenticationListener" interface="com.atlassian.sal.api.auth.AuthenticationListener" />
    <component-import key="authenticationController" interface="com.atlassian.sal.api.auth.AuthenticationController" />
    <component-import key="transactionTemplate" interface="com.atlassian.sal.api.transaction.TransactionTemplate" />

</atlassian-plugin>
